\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{mwhmacros}

% include some default packages.
\RequirePackage{amsmath,amsthm,amssymb}
\RequirePackage{algorithm,algorithmic}
\RequirePackage{mdframed}
\RequirePackage{bm}

\@ifclassloaded{beamer}{}{
% create a few theorem blocks, but do so only if beamer hasn't been loaded (ie
% because beamer creates these itself).
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}{Lemma}
\newtheorem{proposition}{Proposition}
\newtheorem{definition}{Definition}
}

% lets us declare text as upright using \mathup{Text}, but not necessarily
% roman so that they adapt to the current alphabet
\DeclareMathAlphabet{\mathup}{OT1}{\familydefault}{m}{n}

% redefine commands for algorithm.
\renewcommand{\algorithmicrequire}{\textbf{Input:}}
\renewcommand{\algorithmiccomment}[1]{\bgroup\hfill\small\textsl{#1}\egroup}

% box-like environments.
\newmdenv[skipabove=1em]{framed}

% undefine commands we're going to replace.
\let\vec\undefined
\let\H\undefined
\let\d\undefined
\let\i\undefined
\let\P\undefined

% common sets and operators.
\newcommand\R{\mathbb{R}}
\newcommand\N{\mathbb{N}}
\newcommand\Z{\mathbb{Z}}

% common vectors.
\newcommand\zero{\mathbf{0}}
\newcommand\one{\mathbf{1}}

% transposes.
\newcommand\T{^\mathsf{T}}
\newcommand\nT{^{-\mathsf{T}}}
\newcommand\inv{^{-1}}
\newcommand\i{^{i}}

% derivatives.
\newcommand{\dd}[2][]{%
\ifx#1\tfrac{\hphantom{#2}\mathup{d}}{\mathup{d} #2}\else%
      \tfrac{\hphantom{#2}\mathup{d}^{#1}}{\mathup{d} #2^{#1}}}

\newcommand{\dv }[2][]{\tfrac{\partial #1}{\partial #2}}
\newcommand{\dvv}[3][]{\tfrac{\partial^2 #1}{\partial #2 \partial #3}}

% integrand
\newcommand\d{\,\mathup{d}}

% argmax/min operators.
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}

% expectation/variance/etc.
\newcommand{\I}{\mathbb{I}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\H}{\mathup{H}}
\newcommand{\P}{\mathup{P}}
\newcommand{\var}{\mathup{var}}
\newcommand{\cov}{\mathup{cov}}
\newcommand{\corr}{\mathup{corr}}

% matrix operations.
\newcommand{\tr}{\mathup{tr}}
\newcommand{\vec}{\mathup{vec}}
\newcommand{\diag}{\mathup{diag}}
\newcommand{\upper}{\mathup{upper}}

\newcommand{\Array}[1]{\left[\begin{matrix}#1\end{matrix}\right]}

% common distributions.
\newcommand{\Normal}{\mathcal{N}}
\newcommand{\Uniform}{\mathcal{U}}
\newcommand{\Beta}{\mathup{Beta}}
\newcommand{\Bernoulli}{\mathup{Bernoulli}}
\newcommand{\Dir}{\mathup{Dir}}
\newcommand{\GP}{\mathup{GP}}

% list of vectorized quantities
\def\@CAL#1{\expandafter\def\csname cal#1\endcsname{\mathcal{#1}}}
\def\@VEC#1{\expandafter\def\csname v#1\endcsname{\mathbf{#1}}}
\def\@BGR#1{\expandafter\def\csname v#1\endcsname{{\boldsymbol{\csname#1\endcsname}}}}

\def\@cal#1{\ifx#1\@cal\else\@CAL#1\expandafter\@cal\fi}
\def\@vec#1{\ifx#1\@vec\else\@VEC#1\expandafter\@vec\fi}
\def\@bgr#1{\ifx\@bgr#1\else\@BGR{#1}\expandafter\@bgr\fi}

\@vec abcdefghijklmnopqrstuvwxyz\@vec
\@vec ABCDEFGHIJKLMNOPQRSTUVWXYZ\@vec
\@cal ABCDEFGHIJKLMNOPQRSTUVWXYZ\@cal

\@bgr
% lowercase greek symbols
{alpha}{beta}{gamma}{delta}{epsilon}{zeta}{eta}{theta}{gamma}{kappa}{lambda}{mu}
{nu}{xi}{pi}{rho}{sigma}{tau}{phi}{chi}{psi}{omega}
% uppercase greek
{Gamma}{Delta}{Theta}{Lambda}{Xi}{Pi}{Sigma}{Upsilon}{Phi}{Psi}{Omega}
% various other symbols
{ell}
\@bgr

